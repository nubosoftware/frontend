Summary: nubomanagement service
Name: nubomanagement-public-node_modules
Version: %{_version}
Release: %{_release}
Group: System Environment/Daemons
BuildArch: x86_64
License: none
AutoReqProv: no
Requires: nodejs >= 4.4.5, nubomanagement-public-js
BuildRequires: /usr/bin/pathfix.py

%description
nubo management web service that run in public network

#%prep
#%setup -q
#%patch -p1 -b .buildroot

%build
#make -C $NUBO_PROJ_PATH clean
#make -C $NUBO_PROJ_PATH

%install
rm -rf $RPM_BUILD_ROOT
mkdir -p $RPM_BUILD_ROOT/opt/nubomanagement-public

install -m 644 $NUBO_PROJ_PATH/nubomanagement-public/package.json $RPM_BUILD_ROOT/opt/nubomanagement-public/package.json

cd $RPM_BUILD_ROOT/opt/nubomanagement-public/
npm install
rm $RPM_BUILD_ROOT/opt/nubomanagement-public/{package.json,package-lock.json} ||:
find $RPM_BUILD_ROOT/opt/nubomanagement-public/node_modules -type f -exec sed "s?$RPM_BUILD_ROOT?/?g" -i {} \;
pathfix.py -i /usr/bin/python2 -pn $RPM_BUILD_ROOT/opt/nubomanagement-public/node_modules
cd -

%post

%preun

%postun

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)

/opt/nubomanagement-public/node_modules

